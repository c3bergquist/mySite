!function(){var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=e}();var canvas=document.getElementById("world"),ctx=canvas.getContext("2d"),width=canvas.offsetWidth,height=canvas.offsetHeight,keys=[],friction=.9,gravity=.5,boxes=[],player={x:130,y:height-125,width:100,height:100,speed:7,jumpForce:7,velX:0,velY:0,direction:1,jumping:!1,goingDownPipe:!1,grounded:!1,image:new Image},pw=player.width,ph=player.height,sprite={x:538,y:0,w:100,h:100},runTimer=0;player.image.src="./src/images/marioMe_sprites.png",boxes.push({x:-5,y:height,width:width+10,height:10});var firstPipe=width/2-200;function update(){player.goingDownPipe||checkKeys(),getCanvasSize(),ctx.clearRect(0,0,width,height),ctx.beginPath(),player.grounded=!1,setSprite(),drawPlayer(),drawBoxes(),player.goingDownPipe||checkBoxes(),.9<player.velX||player.velX<-.9?player.velX*=friction:player.velX=0,player.grounded?player.velY=0:(player.velY+=gravity,player.y+=player.velY),player.x+=player.velX,player.x>=width-player.width?player.x=width-player.width:player.x<=0&&(player.x=0),requestAnimationFrame(update)}function getCanvasSize(){width=canvas.offsetWidth,height=canvas.offsetHeight}function rebuildWorld(){getCanvasSize(),boxes[0].x=-5,boxes[0].y=height,boxes[0].width=width+10,boxes[0].height=10;var e=width/2-200;boxes[1].x=e,boxes[1].y=height-116,boxes[1].width=96,boxes[1].height=116,boxes[2].x=e+250,boxes[2].y=height-116,boxes[2].width=96,boxes[2].height=116,boxes[3].x=e+500,boxes[3].y=height-116,boxes[3].width=96,boxes[3].height=116,ctx.canvas.width=width,ctx.canvas.height=height}function respawn(){player.x=130,player.y=height-125,player.direction=1,player.grounded=!1}function checkKeys(){(keys[37]||keys[65])&&(player.direction=0,player.velX<=0&&player.velX>-player.speed&&(player.velX-=1)),(keys[39]||keys[68])&&(player.direction=1,0<=player.velX&&player.velX<player.speed&&(player.velX+=1)),(keys[38]||keys[87])&&!player.jumping&&player.grounded&&(player.jumping=!0,player.grounded=!1,player.velY=2*-player.jumpForce)}function drawPlayer(){ctx.drawImage(player.image,sprite.x,0,sprite.w,ph,player.x,player.y,pw,ph)}function drawBoxes(){for(var e=0;e<boxes.length;e++)boxes[e].y=0==e?height:height-116}function checkBoxes(){for(var e=0;e<boxes.length;e++){var t=colCheck(player,boxes[e]);"l"!==t&&"r"!==t||(player.velX=0),"b"===t&&(player.grounded=!0,player.jumping=!1,0<e&&(keys[40]||keys[83])&&goDownPipe(e,boxes[e])),"t"===t&&(player.velY*=-1)}}function colCheck(e,t){var i=e.x+e.width/2-(t.x+t.width/2),r=e.y+e.height/2-(t.y+t.height/2),n=e.width/2+t.width/2,o=e.height/2+t.height/2,a=null;if(Math.abs(i)<n&&Math.abs(r)<o){var s=n-Math.abs(i),y=o-Math.abs(r);y<=s?0<r?(a="t",e.y+=y):(a="b",e.y-=y):0<i?(a="l",e.x+=s):(a="r",e.x-=s)}return a}function setSprites(){sprites.push()}boxes.push({x:firstPipe,y:height-116,width:96,height:116}),boxes.push({x:firstPipe+250,y:height-116,width:96,height:116}),boxes.push({x:firstPipe+500,y:height-116,width:96,height:116}),ctx.canvas.width=width,ctx.canvas.height=height,ctx.save();var counter=0;function setSprite(){player.jumping?1==player.direction?sprite.x=1375:sprite.x=0:0<player.velX&&(keys[37]||keys[65])?stopRight():1<player.velX?runRight():player.velX<-1&&(keys[39]||keys[68])?stopLeft():player.velX<-1?runLeft():(1==player.direction?idleRight():idleLeft(),counter=0)}function idleRight(){sprite.x=750}function idleLeft(){sprite.x=625}function runRight(){counter<150?counter+=1*player.velX:counter=0,counter<=50?sprite.x=875:50<counter&&counter<=100?sprite.x=1e3:100<counter&&counter<=150&&(sprite.x=1125)}function stopRight(){sprite.x=125}function runLeft(){counter<150?counter-=1*player.velX:counter=0,counter<=50?sprite.x=500:50<counter&&counter<=100?sprite.x=375:100<counter&&counter<=150&&(sprite.x=250)}function stopLeft(){sprite.x=1250}function goDownPipe(e,t){player.goingDownPipe=!0;var i=setInterval(function(){gravity=0,player.goingDownPipe=!0,player.x=player.x-(player.x-t.x)/10,player.y+=1},10);"1"==e&&setTimeout(function(){clearInterval(i),window.location.href="./about.html"},1150),"2"==e&&setTimeout(function(){clearInterval(i),window.location.href="./portfolio.html"},1150),"3"==e&&setTimeout(function(){clearInterval(i),window.open("./resume.html","_blank"),window.location.reload(!1)},1150)}window.addEventListener("keydown",function(e){37!=e.keyCode&&38!=e.keyCode&&39!=e.keyCode&&40!=e.keyCode&&65!=e.keyCode&&83!=e.keyCode&&68!=e.keyCode&&87!=e.keyCode||(e.preventDefault(),keys[e.keyCode]=!0,37!=e.keyCode&&65!=e.keyCode||(keys[39]=!1,keys[68]=!1),39!=e.keyCode&&68!=e.keyCode||(keys[37]=!1,keys[65]=!1),40!=e.keyCode&&83!=e.keyCode||(keys[37]=!1,keys[65]=!1,keys[39]=!1,keys[68]=!1))}),window.addEventListener("keyup",function(e){keys[e.keyCode]=!1}),window.addEventListener("load",function(){update()}),window.addEventListener("resize",function(){rebuildWorld(),respawn()});